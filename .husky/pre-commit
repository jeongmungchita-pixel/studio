#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "🔍 Running pre-commit checks..."

# 1. 타입 체크
echo "📝 Type checking..."
npm run typecheck
if [ $? -ne 0 ]; then
  echo "❌ Type check failed"
  exit 1
fi

# 2. 린트 체크
echo "🧹 Linting..."
npm run lint
if [ $? -ne 0 ]; then
  echo "❌ Lint check failed"
  exit 1
fi

# 3. 자동 정리
echo "🔧 Auto-cleaning..."
npm run cleanup:imports
npm run cleanup:console

# 4. 변경사항이 있으면 스테이징
if [ -n "$(git diff --name-only)" ]; then
  echo "📦 Adding cleaned files..."
  git add .
fi

echo "✅ Pre-commit checks passed!"
